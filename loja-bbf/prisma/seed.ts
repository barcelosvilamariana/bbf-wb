import { PrismaClient } from '@prisma/client';
import bcrypt from 'bcryptjs';

const prisma = new PrismaClient();

async function main() {
  console.log('üå± Iniciando seed do banco de dados...');

  // Limpar dados existentes
  await prisma.orderItem.deleteMany();
  await prisma.order.deleteMany();
  await prisma.cartItem.deleteMany();
  await prisma.product.deleteMany();
  await prisma.category.deleteMany();
  await prisma.user.deleteMany();

  console.log('‚úÖ Dados antigos removidos');

  // Criar usu√°rios
  const hashedPassword = await bcrypt.hash('123456', 10);

  const userB2C = await prisma.user.create({
    data: {
      email: 'joao@email.com',
      password: hashedPassword,
      name: 'Jo√£o Silva',
      userType: 'B2C',
      cpf: '12345678900',
      phone: '11999999999',
      street: 'Rua Exemplo',
      number: '123',
      neighborhood: 'Centro',
      city: 'S√£o Paulo',
      state: 'SP',
      zipCode: '01234567',
    },
  });

  const userB2B = await prisma.user.create({
    data: {
      email: 'maria@empresa.com',
      password: hashedPassword,
      name: 'Maria Santos',
      userType: 'B2B',
      cnpj: '12345678000100',
      companyName: 'Empresa Teste LTDA',
      phone: '11988888888',
      street: 'Av. Comercial',
      number: '456',
      neighborhood: 'Empresarial',
      city: 'S√£o Paulo',
      state: 'SP',
      zipCode: '01234567',
    },
  });

  const admin = await prisma.user.create({
    data: {
      email: 'admin@bbf.com.br',
      password: hashedPassword,
      name: 'Administrador BBF',
      userType: 'ADMIN',
      phone: '11977777777',
    },
  });

  console.log('‚úÖ Usu√°rios criados');

  // Criar categorias
  const categories = await Promise.all([
    prisma.category.create({
      data: {
        name: 'Gr√£os e Cereais',
        slug: 'graos-cereais',
        description: 'Arroz, feij√£o, lentilha e outros gr√£os',
        active: true,
      },
    }),
    prisma.category.create({
      data: {
        name: '√ìleos e Azeites',
        slug: 'oleos-azeites',
        description: '√ìleos vegetais e azeites',
        active: true,
      },
    }),
    prisma.category.create({
      data: {
        name: 'Massas',
        slug: 'massas',
        description: 'Massas secas e frescas',
        active: true,
      },
    }),
    prisma.category.create({
      data: {
        name: 'A√ß√∫car e Ado√ßantes',
        slug: 'acucar-adocantes',
        description: 'A√ß√∫car, mel e ado√ßantes',
        active: true,
      },
    }),
    prisma.category.create({
      data: {
        name: 'Bebidas',
        slug: 'bebidas',
        description: 'Caf√©, ch√°, sucos e refrigerantes',
        active: true,
      },
    }),
    prisma.category.create({
      data: {
        name: 'Conservas',
        slug: 'conservas',
        description: 'Enlatados e conservas',
        active: true,
      },
    }),
  ]);

  console.log('‚úÖ Categorias criadas');

  // Criar produtos
  const products = [
    // Gr√£os e Cereais
    {
      name: 'Arroz Tipo 1 - Saco 5kg',
      slug: 'arroz-tipo-1-5kg',
      description: 'Arroz branco tipo 1, gr√£os longos e soltos. Ideal para o dia a dia, com excelente rendimento e qualidade superior.',
      shortDescription: 'Arroz branco tipo 1, gr√£os longos e soltos',
      priceB2C: 25.90,
      priceB2B: 22.50,
      stock: 150,
      sku: 'ARR-001',
      barcode: '7891234567890',
      weight: 5.0,
      unit: 'UN',
      minQuantityB2B: 10,
      categoryId: categories[0].id,
      featured: true,
    },
    {
      name: 'Feij√£o Preto - Pacote 1kg',
      slug: 'feijao-preto-1kg',
      description: 'Feij√£o preto selecionado, tipo 1. Gr√£os uniformes e de alta qualidade, perfeito para o preparo tradicional.',
      shortDescription: 'Feij√£o preto selecionado, alta qualidade',
      priceB2C: 8.90,
      priceB2B: 7.50,
      stock: 200,
      sku: 'FEI-001',
      weight: 1.0,
      unit: 'UN',
      minQuantityB2B: 20,
      categoryId: categories[0].id,
      featured: true,
    },
    {
      name: 'Feij√£o Carioca - Pacote 1kg',
      slug: 'feijao-carioca-1kg',
      description: 'Feij√£o carioca tipo 1, gr√£os selecionados. Cozimento r√°pido e sabor tradicional.',
      shortDescription: 'Feij√£o carioca tipo 1, gr√£os selecionados',
      priceB2C: 7.90,
      priceB2B: 6.80,
      stock: 180,
      sku: 'FEI-002',
      weight: 1.0,
      unit: 'UN',
      minQuantityB2B: 20,
      categoryId: categories[0].id,
    },
    // √ìleos
    {
      name: '√ìleo de Soja - 900ml',
      slug: 'oleo-soja-900ml',
      description: '√ìleo de soja refinado, ideal para cozinhar e fritar. Produto de primeira qualidade, sem colesterol.',
      shortDescription: '√ìleo de soja refinado, ideal para cozinhar',
      priceB2C: 6.90,
      priceB2B: 5.80,
      stock: 300,
      sku: 'OLE-001',
      weight: 0.9,
      unit: 'UN',
      minQuantityB2B: 12,
      categoryId: categories[1].id,
      featured: true,
    },
    {
      name: 'Azeite Extra Virgem - 500ml',
      slug: 'azeite-extra-virgem-500ml',
      description: 'Azeite de oliva extra virgem premium. Primeira prensagem a frio, sabor suave e aroma marcante.',
      shortDescription: 'Azeite de oliva extra virgem premium',
      priceB2C: 32.90,
      priceB2B: 28.50,
      stock: 80,
      sku: 'AZE-001',
      weight: 0.5,
      unit: 'UN',
      minQuantityB2B: 6,
      categoryId: categories[1].id,
      featured: true,
    },
    // Massas
    {
      name: 'Macarr√£o Espaguete - 500g',
      slug: 'macarrao-espaguete-500g',
      description: 'Massa de s√™mola de trigo, cozimento perfeito. Textura al dente e sabor tradicional.',
      shortDescription: 'Massa de s√™mola de trigo, cozimento perfeito',
      priceB2C: 3.90,
      priceB2B: 3.20,
      stock: 180,
      sku: 'MAC-001',
      weight: 0.5,
      unit: 'UN',
      minQuantityB2B: 24,
      categoryId: categories[2].id,
      featured: true,
    },
    {
      name: 'Macarr√£o Penne - 500g',
      slug: 'macarrao-penne-500g',
      description: 'Massa penne de s√™mola de trigo. Formato perfeito para molhos encorpados.',
      shortDescription: 'Massa penne de s√™mola de trigo',
      priceB2C: 3.90,
      priceB2B: 3.20,
      stock: 160,
      sku: 'MAC-002',
      weight: 0.5,
      unit: 'UN',
      minQuantityB2B: 24,
      categoryId: categories[2].id,
    },
    // A√ß√∫car
    {
      name: 'A√ß√∫car Cristal - 1kg',
      slug: 'acucar-cristal-1kg',
      description: 'A√ß√∫car cristal de primeira qualidade. Gr√£os uniformes, ideal para ado√ßar bebidas e receitas.',
      shortDescription: 'A√ß√∫car cristal de primeira qualidade',
      priceB2C: 4.50,
      priceB2B: 3.80,
      stock: 250,
      sku: 'ACU-001',
      weight: 1.0,
      unit: 'UN',
      minQuantityB2B: 30,
      categoryId: categories[3].id,
      featured: true,
    },
    {
      name: 'A√ß√∫car Refinado - 1kg',
      slug: 'acucar-refinado-1kg',
      description: 'A√ß√∫car refinado extra fino. Dissolu√ß√£o r√°pida, perfeito para bolos e doces.',
      shortDescription: 'A√ß√∫car refinado extra fino',
      priceB2C: 5.20,
      priceB2B: 4.50,
      stock: 220,
      sku: 'ACU-002',
      weight: 1.0,
      unit: 'UN',
      minQuantityB2B: 30,
      categoryId: categories[3].id,
    },
    // Bebidas
    {
      name: 'Caf√© Torrado e Mo√≠do - 500g',
      slug: 'cafe-torrado-moido-500g',
      description: 'Caf√© premium, torrado e mo√≠do na hora. Blend especial com notas de chocolate e caramelo.',
      shortDescription: 'Caf√© premium, torrado e mo√≠do na hora',
      priceB2C: 18.90,
      priceB2B: 16.50,
      stock: 120,
      sku: 'CAF-001',
      weight: 0.5,
      unit: 'UN',
      minQuantityB2B: 12,
      categoryId: categories[4].id,
      featured: true,
    },
    {
      name: 'Ch√° Preto - Caixa 25 sach√™s',
      slug: 'cha-preto-25-saches',
      description: 'Ch√° preto premium em sach√™s. Sabor marcante e aroma intenso.',
      shortDescription: 'Ch√° preto premium em sach√™s',
      priceB2C: 8.90,
      priceB2B: 7.50,
      stock: 90,
      sku: 'CHA-001',
      weight: 0.05,
      unit: 'UN',
      minQuantityB2B: 12,
      categoryId: categories[4].id,
    },
    // Conservas
    {
      name: 'Milho Verde em Conserva - 200g',
      slug: 'milho-verde-conserva-200g',
      description: 'Milho verde em conserva, gr√£os inteiros. Pr√°tico e saboroso.',
      shortDescription: 'Milho verde em conserva, gr√£os inteiros',
      priceB2C: 3.50,
      priceB2B: 2.90,
      stock: 200,
      sku: 'CON-001',
      weight: 0.2,
      unit: 'UN',
      minQuantityB2B: 24,
      categoryId: categories[5].id,
    },
    {
      name: 'Ervilha em Conserva - 200g',
      slug: 'ervilha-conserva-200g',
      description: 'Ervilha em conserva, gr√£os tenros. Ideal para saladas e pratos quentes.',
      shortDescription: 'Ervilha em conserva, gr√£os tenros',
      priceB2C: 3.50,
      priceB2B: 2.90,
      stock: 180,
      sku: 'CON-002',
      weight: 0.2,
      unit: 'UN',
      minQuantityB2B: 24,
      categoryId: categories[5].id,
    },
    {
      name: 'Molho de Tomate - 340g',
      slug: 'molho-tomate-340g',
      description: 'Molho de tomate tradicional. Sabor caseiro, sem conservantes.',
      shortDescription: 'Molho de tomate tradicional',
      priceB2C: 4.20,
      priceB2B: 3.50,
      stock: 150,
      sku: 'CON-003',
      weight: 0.34,
      unit: 'UN',
      minQuantityB2B: 24,
      categoryId: categories[5].id,
    },
  ];

  for (const product of products) {
    await prisma.product.create({ data: product });
  }

  console.log('‚úÖ Produtos criados');

  console.log('\nüéâ Seed conclu√≠do com sucesso!');
  console.log('\nüìä Resumo:');
  console.log(`   - ${await prisma.user.count()} usu√°rios`);
  console.log(`   - ${await prisma.category.count()} categorias`);
  console.log(`   - ${await prisma.product.count()} produtos`);
  console.log('\nüë§ Credenciais de teste:');
  console.log('   B2C: joao@email.com / 123456');
  console.log('   B2B: maria@empresa.com / 123456');
  console.log('   Admin: admin@bbf.com.br / 123456');
}

main()
  .catch((e) => {
    console.error('‚ùå Erro no seed:', e);
    process.exit(1);
  })
  .finally(async () => {
    await prisma.$disconnect();
  });
